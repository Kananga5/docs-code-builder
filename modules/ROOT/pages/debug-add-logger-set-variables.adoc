= Add Components to Your American Flights Application

include::reuse::partial$beta-banner.adoc[tag="anypoint-code-builder"] 

//LOGO (web, desktop, or both)
include::partial$acb-ide-logos.adoc[tags="both-ides"]

To facilitate debugging, add Logger and Set Variable components to the implementation in your American Flights project.

== Before You Begin

. xref:design-api-specification-from-scratch.adoc[Create the American Flights API Specification]
. xref:develop-integration.adoc##create-the-american-flights-integration-example[Create the American Flights Integration Example]
. xref:implement-api-specification.adoc[Implement the American Flights API Specification]

== Add Logger and Set Variable Components to Your Implementation

. Open the _implementaion_ file (`implementation.xml`) for your American Flights application.
. Below the Database Select operation (`<db:select/>`) named *Query Flights*, add a Set Variable component. 
. In the configuration XML, provide this `<set-variable/>` configuration:
+
[source,xml]
----
<set-variable value="#[payload]" 
     doc:name="Set variable Payload" 
     variableName="databasePayload" />
----
. Below the Set Variable component, add a Logger component with this configuration:
+
[source,xml]
----
<logger doc:name="Log Payload" message="#[
    %dw 2.0
    output application/json
    ---
    payload]" /> 
----
+
.Click for the complete implementation XML example.
[%collapsible]
====
[source,xml]
--
<flow name="getFlights">
    <logger doc:name="Logger" doc:id="ahcnzm" />
    <db:select doc:name="Query Flights" doc:id="pvuqsc" config-ref="Database_Config" >
        <db:sql>
            <![CDATA[Select * FROM american]]>
        </db:sql>
    </db:select>

    <set-variable value="#[payload]" doc:name="Set variable Payload" 
         variableName="databasePayload" doc:id="vtptsr" />  //<1>

    <ee:transform doc:name="Transform Message" doc:id="uniqueId" >
        <ee:message >
            <ee:set-payload >
                <![CDATA[
                %dw 2.0
                output application/json
                ---
                payload map ( payload01 , indexOfPayload01 ) -> {
                  ID: payload01.ID,
                  code: (payload01.code1 default "") ++ (payload01.code2 default ""),
                  price: payload01.price default 0,
                  departureDate: payload01.takeOffDate as String default "",
                  origin: payload01.fromAirport default "",
                  destination: payload01.toAirport default "",
                  emptySeats: payload01.seatsAvailable default 0,
                  plane: {
                    "type": payload01.planeType default "",
                    totalSeats: payload01.totalSeats default 0
                  }
                }
                ]]>
            </ee:set-payload>
        </ee:message>
    </ee:transform>

<logger doc:name="Log Payload" message="#[
    %dw 2.0
    output application/json
    ---
    payload]" /> //<1>

</flow>
--
[calloutlist]
.. Set Variable component
.. Logger component
====
. Proceed to <<add-breakpoint>>. 
+
Learn to set up breakpoints to pause execution of your application.

[[add-breakpoint]]
== Add a Breakpoint to Your Interface

Add a breakpoint to your American Flights interface:

. Open the _interface_ file (`interface.xml`) for your American Flights project. 
. Select the *Run and Debug* icon in the activity bar:
+
image::run-and-debug.png[]
. Click next to the line in your `<flow-ref>` component to add a breakpoint on that component.
+
image::add-breakpoint.png[]
+
[NOTE]
--
You can also use `F9` to add a breakpoint to the line you are standing on.
--
. On your `implementation.xml` file, add two more breakpoints for the `<db:select>` and the `<set-variable>` components.
. Note that all your breakpoints show up in the *Breakpoints* panel:
+
image::breakpoints-panel.png[]
. Proceed to xref:run-a-debug-session.adoc[Run a Debug Session]. 
+
Run your first debug session and inspect the message and variables at different points during your application's execution.

