= Governing APIs
:page-deployment-options: cloud-ide, desktop-ide
// :page-aliases: 

include::reuse::partial$beta-banner.adoc[tag="anypoint-code-builder"] 

Check conformance of an API specification with rules in governance rulesets and to fix any resulting issues. In Anypoint Code Builder, API specifications are created within or imported into API design projects (see xref:des-create-api-specs.adoc[]).

For information about rulesets and governance, see xref:api-governance::index.adoc#anypoint-api-governance-concepts[Anypoint API Governance Concepts].

[[prereqs]]
== Before You Begin

//TODO: TIME PERMITTING, SHARE INFO FROM RNS HERE VIA INCLUDE
Ensure that your API specification is supported. See API governance xref:acb-release-notes.adoc#compatibility[Compatibility].


[[workflows-tasks]]
== Workflows and tasks

A typical workflow consists of one or more of the following tasks: 

. Add one or more rulesets to a design project. 
+
<<add-rulesets>>
. Run rules in the rulesets to determine if your API specification conforms with the rules.
+
<<run-rules>>
. Fix any conformance issues.
+
<<fix-issues>>


[[add-rulesets]]
== Add Rulesets to a Project

Add governance rulesets from Anypoint Exchange as project dependencies to your API design project. 

Rulesets are hosted on Exchange. MuleSoft provides a number of public rulesets. For example, the ruleset https://anypoint.mulesoft.com/exchange/68ef9520-24e9-4cf2-b2f5-620025690913/anypoint-best-practices/minor/1.6/[Anypoint Best Practices] provides documentation and examples. Your team can also create and publish rulesets for your organization to Exchange (see xref:api-governance::create-custom-rulesets.adoc[]).

. Open your API design project in Anypoint Code Builder.
. Open the *Governance Rulesets* panel in your project. 
. Add a ruleset:

* If the panel does not contain any rulesets, click *Add Rulesets*.
For example:
+
image:anypoint-code-builder::gov-rulesets-add-panel.png["Governance Rulesets panel",width=600]
* If the panel contains rulesets, hover over the panel and click image:anypoint-code-builder::icon-gov-ruleset-add.png["", 15,15] (*Add Governance Rulesets*) to add another ruleset. For example:
+
image:anypoint-code-builder::gov-rulesets-add-panel-not-empty.png["Add ruleset icon",width=600]

. If prompted, sign in to Anypoint Platform.
. Search for the ruleset, and click *Add Rulesets*. For example:
+
image:anypoint-code-builder::gov-rulesets-search-add.png["All Available Rulesets",width=600]
+
You can also select specific organizations from the *Any organization* menu, and you can select a different version of a ruleset if more than one version is available.
. Proceed to <<run-rules>>.

[[run-rules]]
== Run Rules against Your API Specification 

Run governance rules to validate your API specifications. Governance rules are part of rulesets.

. Open your design project.
. Open the *Governance Rulesets* panel to check for rulesets in your project.

* If rulesets are present, proceed to the next step.
+
image:anypoint-code-builder::gov-rulesets-add-panel-not-empty.png["Add ruleset icon",width=500]
* If rulesets are not present or if you intend to add more rulesets, go to <<add-rulesets>>.
+
image:anypoint-code-builder::gov-rulesets-add-panel.png["Governance Rulesets panel",width=500]
. Run your rulesets from the *Governance Rulesets* panel.
+
You can run rulesets at multiple levels:

* All rules in all rulesets
+
image:anypoint-code-builder::gov-rulesets-run-all.png["Clicking icon to run all rulesets",width=500]
* All rules in a single ruleset
+
image:anypoint-code-builder::gov-rulesets-run-ruleset.png["Clicking icon to run a rulesets",width=500]
* A single rule in a ruleset
+
image:anypoint-code-builder::gov-rulesets-run-rule.png["Clicking icon to run a rule",width=500]
+
You can monitor the rules as they run. For example:
+
image:anypoint-code-builder::gov-rulesets-running.png["Rules running in the panel",width=500]

. If any rules return a warning or error, proceed to <<fix-issues>>.
+
For example, this ruleset returns a warning on some rules:
+
image:anypoint-code-builder::gov-rulesets-warning.png["Ruleset with warnings",width=500]
+
The output panel Governance Rulesets also identifies any warnings or errors. For example:
+
image:anypoint-code-builder::gov-rulesets-warning-output.png["Ruleset with warnings",width=700]

[[fix-issues]]
== Fix Validation Issues

TODO_TOPIC: Check trace to get info on rule failures (and clues about how to fix)
Navigate from rule validation failure to node generating failure (goal: to find and fix validation failure more quickly)







