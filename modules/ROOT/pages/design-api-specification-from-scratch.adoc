= Create the American Flights API Example

include::reuse::partial$beta-banner.adoc[tag="anypoint-code-builder"]

//LOGO (web, desktop, or both)
include::partial$acb-ide-logos.adoc[tags="both-ides"]

Use Anypoint Code Builder to create an API specification example called American Flights API. In this API, reuse API fragments from Anypoint Exchange, create data types and response examples, test your API using API Console, save your API to Design Center, and publish the API as an asset to Exchange.

After following all the steps to complete the specification, you can xref:implement-api-specification.adoc[implement] the specification within an xref:develop-integration.adoc[integration].

== Start the Specification for API Example

Start creating the American Flights API specification. 

image::acb-api-project.png["Project for American Airlines API"]

. In the activity bar, click the MuleSoft icon to navigate to Anypoint Code Builder.
+
For more guidance, see xref:design-api-specification.adoc[].
. From the *Quick Actions* menu, click *Design an API* from the Anypoint Code Builder menu to start the API specification project:
 
* In the *Project Name* field, provide the name *American Flights API* your API specification project.
* In the *Project Location* field, select *Browse*, and then select your home directory.
* In the *API Specification Language* field, select *RAML 1.0*.
* In the *Business Group* field, select the business group for your API specification.
. Select *Create Project* to generate an American Flights API project with the file `american-flights-api.raml`.
. Proceed to <<add-resource>>.

[[add-resource]]
=== Add a RAML Resource and Methods

In American Flights API, start the specification and try GET method in API Console. 

. Open `american-flights-api.raml` from your project.
. Paste this RAML code for the `/flights` endpoint into the file:
+
[source,raml,linenums]
--
#%RAML 1.0
title: American Flights API

/flights:
--
. Press Ctrl+Space to display all the available options, and add a `get` method.
. On the next line directly under `get`, add a `post` method.
+
[source,RAML]
----
#%RAML 1.0
title: American Flights API

/flights:
  get:
  post:
----
+
. Click the API Console icon to display your specification in the console.
+
image::acb-api-console.png["A specification with get and post methods"]
+
Endpoint and methods in the API console:
+
//TODO: Consider changing image. The API Console shows "Documentation" as the title instead of the project's name created.
image::get-post-methods-api-console.png["GET and POST methods highlighted in *API Console*"]
//TODO: hn: this is not the case for me. I see the name of the raml file.
//TODO: duke: I'm getting weirdness of Documentation, but I can click the hamburger in the console to display the API Console. Is this a BUG???

[[add-resource]]
== Add Query Parameters and Nested Resources

Add resources to a nested resource (`/{ID}:`) to use as a dynamic selector, and specify query parameters (`queryParameters:`) as a set of `enum` values to use for requesting the destination of the flight. 

. Replace your RAML content with this specification:
+
[source,raml,linenums]
--
#%RAML 1.0
title: American Flights API

/flights:
  get:
    queryParameters:
      destination:
        required: false
        enum:
          - SFO
          - LAX
          - CLE
  post:

  /{ID}:
    get:
--
. Open the API Console to display the nested resource:
+
image::sub-methods-api-console.png["API Console with nested resource"]
. Proceed to <<add-fragments>>.

[[add-fragments]]
== Add API Fragments for a Data Type and Example from Anypoint Exchange

Add these fragments to the project directory:

* *Training: American Flight Data Type* for a Flight object
* *Training: American Flights Example* for data that the flights API returns

Adding the fragments is a precondition to including them in your specification.

To add the fragments: 

. In Anypoint Code Builder, open `american-flights-api.raml`.
. Open the Command Palette by pressing Ctrl+Shift+p (Windows) or Cmd+Shift+p (Mac), and provide this command:
+
[source,command]
----
MuleSoft: Add fragment dependency from Exchange
----
. Provide the name of the asset to add:
+
[source,command]
----
Training: American Flight Data Type
----
. Select the latest version of the asset.
+
When the process is complete, the status bar displays the message *Dependencies successfully added*.
. From the Command Palette, add a fragment:
+
[source,command]
----
MuleSoft: Add fragment dependency from Exchange
----
. Provide the name of the asset to add:
+
[source,command]
----
Training: American Flights Example
----
. Select the latest version of the *American Flights Example* asset.
+
The fragments are now in the `/exchange_modules` directory of your project.
. Proceed to xref:add-request-response-details.adoc[].