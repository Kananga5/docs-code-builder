= Configuring DataWeave Expressions

Configure DataWeave expressions in your integrations and implementations from the expression builder UI or from the configuration XML. Mock data for your expressions so that you can preview sample output of your expressions in Anypoint Code Builder.

* <<expression-builder>>
* <<sample-data>>

//TODO: CONVERT TO INCLUDE FOR SHARING
DataWeave is the programming language designed by MuleSoft for data transformation within a Mule app. DataWeave is also the expression language Mule runtime engine uses to configure components and connectors. When you create an implementation or integration in Anypoint Code Builder, you are creating a Mule app that runs on an instance of the Mule runtime engine. 

//TODO_TODO BE SURE TO COVER ALL OF THESE IN SOME WAY:
// * When a user clicks on a field that accepts DataWeave - a side car should be opened to the left of the Component Configuration Panel.
// * Users should be able to either click on their data to insert it into the text area or begin typing to see a list of auto-complete options to choose from
// * Hovering over a datapill should show insights
// * Users should have the ability to minimize the sidecar by clicking on the following icon

== Before You Begin

It is important to have a basic understanding of the DataWeave language. DataWeave expressions accept the following: 

* xref:dataweave::dw-functions.adoc[DataWeave functions and operators] and data types that their parameters accept. For example, the concatenation function (xref:dataweave::dw-core-functions-plusplus.adoc[++]) accepts strings, arrays, objects, date-related data types, and so on. 
* xref:dataweave::dataweave-variables-context.adoc[Predefined Mule variables] such as `payload`, `attributes`, `vars`.
* xref:dataweave::dataweave-selectors.adoc[DataWeave selectors] for capturing the values of fields within the payload, attribute, or variable within the xref:mule-runtime::about-mule-event.adoc[Mule event]. 

For more information, see xref:dataweave::index.adoc[]. 

[[expression-builder]]
== Expression Builder

When configuring component in your flows, use the DataWeave expression builder to ease configuration of DataWeave expressions in your components, to supply sample data for your expression, and to preview the expression's output without the need to run your Mule app with data from external sources. To provide your own sample data, see <<sample-data>>.

* *Data*: Illustrates the data structure with any sample data that is available. For example:
+
image:int-dw-fx-data-tab.png["Data tab for expression field"]
+
The strings displayed as values for the payload and attributes, such as *"0"* and *"75"*, are not used for previewing or generating output.  

* *Functions*: Lists all DataWeave functions from all xref:dataweave::dw-functions.adoc#dw_modules[DataWeave modules], such as String, Array, and Core modules. 
+
[%header,cols="1a,1a"]
|===
| DataWeave Functions
| Function Reference

| 
Hover over a function to get a short description:

image:int-dw-fx-functions-tab.png["Functions tab for expression field"]
|
Click *Details* to get complete documentation:

image:int-dw-fx-functions-tab-details.png["Data tab for expression field"]
|===

//TODO: within the fx field in the UI, you can also do Ctrl-space to get a list of Core functions only?

* *Preview*: Preview auto-generated sample data, or create your own sample data.
+
[%header,cols="1a,1a"]
|===
| Preview Auto-generated Sample Data
| Preview Your Sample Data

| 
Outputting results from auto-generated sample data:

image:int-dw-fx-preview-tab.png["Functions tab for expression field"]
|
Outputting results from an expression with user-created sample data:

image:int-dw-fx-preview-tab-output.png["Data tab for expression field"]
|===
+
You can apply DataWeave selectors and functions to your sample data. To create sample data that has the structure and data types you expect, see <<sample-data>>.

[[display-event]]
== Display Mule Event Metadata


[[preview]]
== Preview Output of DataWeave Scripts and Variables





[[sample-data]]
== Provide Sample Data for a DataWeave Expression

Add sample data for Mule variables, such as `payload` in *fx* fields so that you can test and preview DataWeave expressions in your components locally, without running your application to retrieve Mule event data from an external source.

You can create sample data in the following formats:

* JSON
* XML
* CSV

To create sample data for a Mule variable:

. Hover over the Mule variable for which you want to provide sample data. For example:
+
TODO: ADD IMAGE
. Click *Quick Fix* to open the Quick Fix menu.
. Select *Create sample data for _your-value_*, such as *Create sample data for payload*.
. In the menu that opens, select a format for the sample data, such as JSON. 
+
image::dw-issue-sample-data-formats.png["Menu of Sample Data File Formats"]
+
The IDE creates a file for your sample data. For example:
+
TODO: ADD IMAGE
. Modify the default content in the file to create your own sample data in the selected format. For example:
+
TODO: ADD IMAGE
+
Hovering over the value now displays the type and structure of your sample data. 
+
TODO: ADD IMAGE 
. Preview your sample data from the expression builder UI:
.. From the canvas UI, click the component that contains your sample data. 
.. Click the field of the component that contains the sample data to open the expression builder for that field. For example:
+
TODO: ADD IMAGE 
.. In the expression builder, click *Data* to display your sample data within the data structure. For example: 
+
TODO: ADD IMAGE 
.. In the expression builder, click *Preview* to display the sample data. 
+
TODO: ADD IMAGE 

== See Also

* xref:int-debug-mule-apps.adoc[]
* xref:troubleshoot-dataweave.adoc[]
* xref:int-create-integrations.adoc#add-components[Add a Component to Your Project]

