= Run a Debug Session

After setting up your debug conditions, you can run a debug session and evaluate your Mule application at each breakpoint.

== Before You Begin

* You designed an API specification. +
See xref:design-api-specification.adoc[].
* You developed an integration. +
See xref:develop-integration.adoc[].
* You implemented the API. +
See xref:implement-api-specification.adoc[].
* You added components to help your debug. +
See xref:debug-add-logger-set-variables.adoc[].
* You added breakpoints. +
See xref:debug-add-breakpoints.adoc[].
* Install a REST client like Postman or AdvancedRestClient.

== Start a Debug Session

. In Anypoint Code Builder, on your Run and Debug view, select your *Run and Debug* icon.
+
image::start-debugging.png[]
. Your application is first packaged, and then Anypoint Code Builder opens a new terminal that deploys the application to the embedded Mule Runtime:
+
image::packaged-and-running-terminals.png[]

== Test Your Mule Application

. Make a `GET` request to `+https://<web-IDE-instance>/api/8081/flights+`. +
See xref:ping-locally-deployed-app.adoc[] for more information on how to send request to your application.
. In Anypoint Code Builder, notice that the application execution stopped at your first breakpoint.
+
image::debug-stop-at-flow-ref.png[]
. Select the *Step Over* button on your debug toolbar to move the execution to your next breakpoint.
. In the Debug sidebar, notice that the *Variables* panel shows details about the Mule event at that particular part of the flow.
+
image::debugger-stop-db-select.png[]
. Select the *Step Over* button on your debug toolbar to move the execution to your next breakpoint.
. In the Debug sidebar on the *Variables* panel, expand the *Mule Message* and the *Payload* variables and note that you can inspect the database response as an array.
+
image::debugger-stop-set-variable.png[]

== Add a Watch Expression

. In the Debug sidebar, in the Watch panel, select the `plus` icon.
+
image::debug-add-expression.png[]
. Add the expression `payload.^mediaType`.
. Select the *Step Over* button until your execution moves to the `<set-payload>` component.
. Note that your payload is `application/java`.
. Select the *Step Over* button until your execution to the `<logger>` component.
. Note that your payload is now transformed to `application/json`.
+
image::debuger-watch-expression-json.png[]
. Select the *Continue* button on your debug toolbar. Note that the application returns the response from the database to your REST client.
+
[source,JSON]
--
[
    {
        "ID": 1,
        "code": "rree0001",
        "price": 541,
        "departureDate": "2016-01-20T00:00:00",
        "origin": "MUA",
        "destination": "LAX",
        "emptySeats": 0,
        "plane": {
            "type": "Boeing 787",
            "totalSeats": 200
        }
    },
    {
        "ID": 2,
        "code": "eefd0123",
        "price": 300,
        "departureDate": "2016-01-25T00:00:00",
        "origin": "MUA",
        "destination": "CLE",
        "emptySeats": 7,
        "plane": {
            "type": "Boeing 747",
            "totalSeats": 345
        }
    },
    {
        "ID": 3,
        "code": "ffee0192",
        "price": 300,
        "departureDate": "2016-01-20T00:00:00",
        "origin": "MUA",
        "destination": "LAX",
        "emptySeats": 0,
        "plane": {
            "type": "Boeing 777",
            "totalSeats": 300
        }
    },
    {
        "ID": 4,
        "code": "rree1000",
        "price": 200,
        "departureDate": "2016-01-20T00:00:00",
        "origin": "MUA",
        "destination": "CLE",
        "emptySeats": 5,
        "plane": {
            "type": "Boeing 737",
            "totalSeats": 150
        }
    },
    {
        "ID": 5,
        "code": "rree1093",
        "price": 142,
        "departureDate": "2016-02-11T00:00:00",
        "origin": "MUA",
        "destination": "SFO",
        "emptySeats": 1,
        "plane": {
            "type": "Boeing 737",
            "totalSeats": 150
        }
    },
    {
        "ID": 6,
        "code": "ffee1112",
        "price": 954,
        "departureDate": "2016-01-20T00:00:00",
        "origin": "MUA",
        "destination": "CLE",
        "emptySeats": 100,
        "plane": {
            "type": "Boeing 787",
            "totalSeats": 200
        }
    },
    {
        "ID": 7,
        "code": "eefd1994",
        "price": 676,
        "departureDate": "2016-01-01T00:00:00",
        "origin": "MUA",
        "destination": "SFO",
        "emptySeats": 0,
        "plane": {
            "type": "Boeing 777",
            "totalSeats": 300
        }
    },
    {
        "ID": 8,
        "code": "ffee2000",
        "price": 300,
        "departureDate": "2016-02-20T00:00:00",
        "origin": "MUA",
        "destination": "SFO",
        "emptySeats": 30,
        "plane": {
            "type": "Boeing 737",
            "totalSeats": 150
        }
    },
    {
        "ID": 9,
        "code": "eefd3000",
        "price": 900,
        "departureDate": "2016-02-01T00:00:00",
        "origin": "MUA",
        "destination": "SFO",
        "emptySeats": 0,
        "plane": {
            "type": "Boeing 737",
            "totalSeats": 150
        }
    },
    {
        "ID": 10,
        "code": "eefd4511",
        "price": 900,
        "departureDate": "2016-01-15T00:00:00",
        "origin": "MUA",
        "destination": "LAX",
        "emptySeats": 100,
        "plane": {
            "type": "Boeing 777",
            "totalSeats": 300
        }
    },
    {
        "ID": 11,
        "code": "rree4567",
        "price": 456,
        "departureDate": "2016-01-20T00:00:00",
        "origin": "MUA",
        "destination": "SFO",
        "emptySeats": 100,
        "plane": {
            "type": "Boeing 737",
            "totalSeats": 150
        }
    }
]
--

== Stop Debug Session

To stop your debug session, select the *Stop* button on your debug toolbar.

image::debugger-stop.png[]

== Next Step

* Move to a new section of the tutorial and learn how to xref:deploy-mule-application.adoc[Deploy a Mule Application].
