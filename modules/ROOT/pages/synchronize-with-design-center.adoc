= Synchronize the API Specification with Design Center
:page-aliases: tut-api-synchronize-with-design-center.adoc

include::reuse::partial$beta-banner.adoc[tag="anypoint-code-builder"] 

//LOGO (web, desktop, or both)
include::partial$acb-ide-logos.adoc[tags="both-ides"]

Use the built-in integrated source control management (SCM) to sync American Flights API with Anypoint Design Center (Design Center). The Design Center SCM is built on Git.

== Before You Begin

If you haven't started the American Flight API specification, follow these procedures before attempting to synchronize:

. xref:tut-api-design-api-specification-from-scratch.adoc[]
. xref:tut-api-add-request-response-details.adoc[]
. xref:tut-api-test-api-specification.adoc[]

[[review]]
== Review Changes in Files

Anypoint Code Builder highlights differences made in files since you last synced them with the main branch on Design Center.

When you change your API specification, the Source Control icon in the Activity Bar displays an overview of how many changes you currently have. Selecting the icon shows you the details of your current changes:

* *Changes*
* *Staged Changes*

//TODO: Web IDE only because it contains hamburger menu. Need to make generic. Plus, take a SS in a lower resolution, or only a part of the screen. Hi-res SS are hard to read in a 13 inch display.
//TODO duke: fix/modify screenshot
image::changes-and-staged-changes.png["Changes and Staged Changes highlighted in the source control section"]

To review your changes to your API specification:

. In Anypoint Code Builder, select your *Source Control* view (`ctrl+shift+G`).
. Open your `exchange.json` file.
. Review the working tree and see how deletions (red) and additions (green) are highlighted.
+
//TODO: Web IDE only because it contains hamburger menu. Need to make generic. Plus, take a SS in a lower resolution, or only a part of the screen. Hi-res SS are hard to read in a 13 inch display.
//TODO duke: fix/modify screenshot
image::explore-changes-api-specification.png["exchange.json file highlighted to show the source control changes"]
+
In this case, you added some dependencies to the API by reusing API fragments you downloaded from Anypoint Exchange.
. Proceed to <<stage>> or <<stage-multiple-changes>> to stage your changes one at a time or together.

[[stage]]
== Stage Your Changes Individually

The `git add` command adds a change from your working directory to the staging area. This command informs Git that you want to include updates to a particular file in the next commit. In Anypoint Code Builder you can do this by using the buttons in the UI:

. In Anypoint Code Builder, select your Source Control view.
. Select the plus icon in the `american-flight-api.raml` file.
+
//TODO: Web IDE only because it contains hamburger menu. Need to make generic. Plus, take a SS in a lower resolution, or only a part of the screen. Hi-res SS are hard to read in a 13 inch display.
//TODO duke: fix/modify screenshot
image::stage-american-flights-api.png["Source control number and plus icon of american-flight-api.raml file highlighted"]
. Review the changes in the Source Control section. The file moves into *Staged Changes*.
+
//TODO: Web IDE only because it contains hamburger menu. Need to make generic. Plus, take a SS in a lower resolution, or only a part of the screen. Hi-res SS are hard to read in a 13 inch display.
//TODO duke: fix/modify screenshot
image::staged-changes.png["Working tree of american-flight-api.raml file highlighted"]
+
Alternatively, you can perform these actions using the command line embedded in the IDE. 
. Proceed to <<commit>>.

[[stage-multiple-changes]]
=== Stage Multiple Changes

You can add multiple files at the same time:

. In Anypoint Code Builder, select your Source Control view.
. Click the plus icon in the section header to stage the remaining changes.
+
//TODO: Web IDE only because it contains hamburger menu. Need to make generic.
//TODO duke: fix/modify screenshot
image::stage-all-changes.png["Plus icon highlighted to stage all changes"]
+
Alternatively, you can perform these actions from the command line embedded in the IDE.
. Proceed to <<commit>>.

[[commit]]
== Commit Changes

Use the `git commit` command to save the changes you staged to your local repository:

. In Anypoint Code Builder, select your Source Control view.
. Click in the message box.
. Enter a message that summarizes your changes.
+
//TODO: Web IDE only because it contains hamburger menu. Need to make generic.
//TODO duke: fix/modify screenshot
image::add-commit-message.png["Message box highlighted"]
+
A good commit message helps summarize the changes across multiple files by multiple developers.
. Click the tick mark in the *Source Control* header to commit the changes.
+
//TODO: Web IDE only because it contains hamburger menu. Need to make generic.
//TODO duke: fix/modify screenshot
image::commit-changes.png["Tick mark in the Source Control header highlighted"]
. Your Source Control view now displays no changes to commit.
. Proceed to <<push>>.

[[push]]
== Push Changes to Anypoint Design Center

Use the `git push` command to upload your local content to Anypoint Design Center:

. In Anypoint Code Builder, select your Source Control view.
. Select the three dots that appear in the *Source Control* header.
. Select *Push*.
+
//TODO: Web IDE only because it contains hamburger menu. Need to make generic.
//TODO duke: fix/modify screenshot
image::push-changes.png["Push command highlighted in the source control section"]
+
Your changes are now published in Design Center.
+
The integrated SCM within Anypoint Code Builder might prompt you to `periodically run 'git fetch'`. This option enables Anypoint Code Builder to check for updates of your API in Design Center and prompt you to update your local version of the API.
+
image::fetch-periodically-check.png["Periodically run git fetch message highlighted"]
. Proceed to xref:tut-api-publish-api-spec-to-exchange.adoc[] so that your team can find and implement the specification.
