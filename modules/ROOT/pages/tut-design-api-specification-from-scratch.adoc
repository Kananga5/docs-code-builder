= Create the American Flights API Example
:page-aliases: design-api-specification-from-scratch.adoc

include::reuse::partial$beta-banner.adoc[tag="anypoint-code-builder"]

//LOGO (web, desktop, or both)
include::partial$acb-ide-logos.adoc[tags="both-ides"]

Use Anypoint Code Builder to create an API specification example called American Flights API. In this API, reuse API fragments from Anypoint Exchange, create data types and response examples, test your API using API Console, save your API to Design Center, and publish the API as an asset to Exchange.

To build, test, and synchronize, and publish the specification:

. <<start-spec>>
. <<add-flight-resource>>
. <<add-query-params-nested-resources>>
. xref:tut-design-api-add-request-response-details.adoc[]
. xref:tut-design-api-test-specification.adoc[]
. xref:tut-design-api-synchronize-with-design-center.adoc[]
. xref:tut-design-api-publish-api-spec-to-exchange.adoc[]

After creating, testing, synchronizing, and publishing the American Flights API specification, you can xref:implement-api-specification.adoc[implement] the specification within an xref:develop-integration.adoc[integration].

[[start-spec]]
== Start American Flights API

Start creating the American Flights API specification. 

image::acb-api-project.png["Project for American Airlines API"]

. In the activity bar of the IDE, click the *Anypoint Code Builder* (MuleSoft) icon to navigate to Anypoint Code Builder.
+
For more guidance, see xref:design-api-specification.adoc#start-spec[Start an API Specification].
. From the *Quick Actions* menu, click *Design an API* from the Anypoint Code Builder menu to start the API specification project:
+
[%header,cols="1a,1a"] 
|===
| Field Name | Field Value

| *Project Name* | *American Flights API* or a similar name of your choice
| *Project Location* | Your home directory or another directory you create
| *API Specification Language* | *RAML 1.0*
| *Business Group* | Group for your API specification
|===
. Select *Create Project* to generate the American Flights API project file: `american-flights-api.raml`.
+
The file name is based on the name you provide for the project.
. Proceed to <<open-project>>.

[[open-project]]
== Open the Workspace for Your API Specification Project

To open your project's workspace from the Command Palette:

. Press Cmd+shift+p (Mac) or Ctrl+shift+p (Windows), and provide this command:
+
[source,command]
----
File: Open Folder
----
. Navigate to your project's _root_ folder and not to a parent or child folder.
+
VS Code treats the folder you open as a workspace.

. In the Explorer view, find the RAML file for your project, for example, `american-flights-api.raml`.
. Proceed to <<add-flight-resource>>.

[[add-flight-resource]]
=== Add a RAML Resource and Methods

In American Flights API, start configuring the specification, and try its *GET* method from the API Console. 

. In `american-flights-api.raml`, paste this RAML code for the `/flights` endpoint and `get` method into the file:
+
[source,raml,linenums]
--
#%RAML 1.0
title: American Flights API

/flights:
  get:
--
. On the next line directly under `get`, press Ctrl+Space to display all the available options, and select a `post` method.
+
[source,RAML]
----
#%RAML 1.0
title: American Flights API

/flights:
  get:
  post:
----
+
. Click the API Console icon to display your specification in the console.
+
image::acb-api-console.png["A specification with get and post methods"]
+
Wait for the API Console to load. 
+
Endpoint and methods in the API console:
+
//TODO: Consider changing image. The API Console shows "Documentation" as the title instead of the project's name created.
image::get-post-methods-api-console.png["GET and POST methods highlighted in *API Console*"]
//TODO: hn: this is not the case for me. I see the name of the raml file.
//TODO: duke: I'm getting weirdness of Documentation, but I can click the hamburger in the console to display the API Console. Is this a BUG???
. Proceed to <<add-query-params-nested-resources>>.

[[add-query-params-nested-resources]]
== Add Query Parameters and Nested Resources

Add a nested resource (`/{ID}:`) to use for getting a flight based on its destination, and specify optional query parameters for the destinations (`queryParameters:`) as a set of `enum` values. 

. Replace your RAML content with this specification:
+
[source,raml,linenums]
--
#%RAML 1.0
title: American Flights API

/flights:
  get:
    queryParameters:
      destination:
        required: false
        enum:
          - SFO
          - LAX
          - CLE
  post:

  /{ID}:
    get:
--
. Open the API Console to display the nested resource:
+
image::sub-methods-api-console.png["API Console with nested resource"]
. Proceed to xref:tut-design-api-add-request-response-details.adoc[].
