= Synchronize the API Specification with Design Center
:page-aliases: synchronize-with-design-center.adoc

include::reuse::partial$beta-banner.adoc[tag="anypoint-code-builder"] 

//LOGO (web, desktop, or both)
include::partial$acb-ide-logos.adoc[tags="both-ides"]

Use the built-in integrated source control management (SCM) to sync American Flights API with Anypoint Design Center (Design Center). The Design Center SCM is built on Git.

== Before You Begin

If you haven't started the American Flight API specification, follow these procedures before attempting to synchronize:

. xref:tut-design-api-specification-from-scratch.adoc[]
. xref:tut-design-api-add-request-response-details.adoc[]
. xref:tut-design-api-test-specification.adoc[]

[[review]]
== Review Changes in Files

Identify changes to files in your API project since the last synchronization with the main branch in Design Center. When you change your API project, the Source Control icon in the Activity Bar identifies the number of changes to the API project. 

//TODO duke: hamburger menu present; maybe ok since it's fairly inobtrusive
image::changes-and-staged-changes.png["Changes and Staged Changes highlighted in the source control section"]

To review changes to your API project:

. In Anypoint Code Builder, open the *Source Control* menu by pressing Ctrl+Shift+g (Mac) or Cmd+Shift+g (Windows).
+
Alternatively, click the *Source Control* icon in the activity bar.
. Open your `exchange.json` file.
. Review the working tree and notice the shading for deletions (red) and additions (green).
+
//TODO duke: hamburger menu present; maybe ok if fairly inobtrusive
image::explore-changes-api-specification.png["exchange.json file highlighted to show the source control changes"]
+
This example adds some dependencies to the API specification by reusing the API fragments downloaded from Anypoint Exchange.
. Proceed to <<stage>> to stage your changes one at a time.
+
Alternatively, you can stage multiple files together through <<stage-multiple-changes>>.

[[stage]]
== Stage Changes to the Built-in SCM

Stage changes from one or more files from the UI or through the command line, with a Git command. The UI uses the `git add` command to add changes from your working directory to the staging area. This area includes updates for the next commit.

* <<stage-one>>
* <<stage-multiple>>

[[stage-one]]
=== Stage Changes to a Single File

To stage individual changes through the UI:

. In Anypoint Code Builder, select your Source Control view.
. Select the plus icon beside the specification file, `american-flight-api.raml`.
+
//TODO duke: fix/modify screenshot
image::stage-american-flights-api.png["Source control number and plus icon of american-flight-api.raml file highlighted"]
+
The file moves to *Staged Changes* section.
. Review the changes in the Source Control section.
. Proceed to <<stage-multiple-changes>> to stage changes to more than one file in your API project.

[[stage-multiple]]
=== Stage Changes to Multiple Files

Stage multiple files at the same time:

. Select your Source Control view for your API project.
. Click the plus icon in the *Changes* the section header to stage the remaining changes.
+
image::stage-all-changes.png["Plus icon highlighted to stage all changes"]
. Proceed to <<commit>>.

[[commit]]
== Commit Changes

The UI uses the `git commit` command to save the changes you staged to your local repository. 

To commit staged changes:

. In Anypoint Code Builder, select your Source Control view.
. Click in the message box.
. Enter a message that summarizes your changes.
+
//TODO: Web IDE only because it contains hamburger menu. Need to make generic.
//TODO duke: fix/modify screenshot
image::add-commit-message.png["Message box highlighted"]
+
A good commit message helps summarize the changes across multiple files by multiple developers.
. Click the tick mark in the *Source Control* header to commit the changes.
+
//TODO: Web IDE only because it contains hamburger menu. Need to make generic.
//TODO duke: fix/modify screenshot
image::commit-changes.png["Tick mark in the Source Control header highlighted"]
. Your Source Control view now displays no changes to commit.
. Proceed to <<push>>.

[[push]]
== Push Changes to Anypoint Design Center

The UI uses the `git push` command to upload your local content to Anypoint Design Center.

To push your changes:

. In Anypoint Code Builder, select your Source Control view.
. Select the three dots that appear in the *Source Control* header.
. Select *Push*.
+
//TODO: Web IDE only because it contains hamburger menu. Need to make generic.
//TODO duke: fix/modify screenshot
image::push-changes.png["Push command highlighted in the source control section"]
+
Your changes are now published in Design Center.
+
The integrated SCM within Anypoint Code Builder might prompt you to `periodically run 'git fetch'`. This option enables Anypoint Code Builder to check for updates of your API in Design Center and prompt you to update your local version of the API.
+
image::fetch-periodically-check.png["Periodically run git fetch message highlighted"]
. Proceed to xref:tut-api-publish-api-spec-to-exchange.adoc[] so that your team can find and implement the specification.
